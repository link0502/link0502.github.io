<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 虚拟机最小化安装centos7 之一《网络设置》 · link0502</title><meta name="description" content="虚拟机最小化安装centos7 之一《网络设置》 - Mr.Leng"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/prontera.css"><link rel="search" type="application/opensearchdescription+xml" href="http://weibo.com/link0502/atom.xml" title="link0502"></head><body><header class="feature-header"><nav class="component-nav"><ul><div class="logo-container"><a href="/"><h2 class="title">link0502</h2></a></div><a href="/" target="_self" class="li component-nav-item"><p>现在</p></a><a href="/archives" target="_self" class="li component-nav-item"><p>曾经</p></a><ul class="shortcut-icons"><a href="https://github.com/link0502" target="_blank"><img src="/images/github.svg" class="icon"></a><a href="/atom.xml" target="_blank"><img src="/images/rss.svg" class="icon"></a></ul></ul></nav></header><main class="container"><div id="post-container"><div class="post"><article class="post-block"><h1 class="post-title">虚拟机最小化安装centos7 之一《网络设置》</h1><div class="post-info">Nov 29, 2017</div><div class="post-content"><p>网上有很多教程，但是还是需要自己摸索的。</p>
<p>虚拟机环境：VMware Workstation </p>
<p>ISO镜像：CentOS-7-x86_64-Minimal-1708.iso</p>
<p>安装完好网络是不通的，需要进行虚拟机设置和Centos设置。</p>
<p>第一步：首先在虚拟网络编辑器里面，进行NAT设置（注意看下网关IP，一会Centos设置要用），然后将Centos的网络设置为NAT模式。</p>
<p>第二步：Centos设置，进入/etc/sysconfig/network-scripts/ 目录，查看ifcfg开头的两个文件，网上的教程大多写的是enp0s3，这个无所谓的。</p>
<p>本机的配置文件名字不一定是。下图是我的：</p>
<p><img src="http://nav.ewwe.net/share/10001.png" alt="GitHub"></p>
<p>其中ifcfg-lo为本机Loopback地址，就是本机回环地址。我们需要修改的就是ifcfg-ens33地址。按如下修改：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BOOTPROTO=”static” <span class="comment">#dhcp改为static</span></span><br><span class="line">ONBOOT=”yes” <span class="comment">#开机启用本配置</span></span><br><span class="line">IPADDR=192.168.7.106 <span class="comment">#静态IP</span></span><br><span class="line">GATEWAY=192.168.7.1 <span class="comment">#默认网关</span></span><br><span class="line">NETMASK=255.255.255.0 <span class="comment">#子网掩码</span></span><br><span class="line">DNS1=192.168.7.1 <span class="comment">#DNS 配置</span></span><br></pre></td></tr></table></figure></p>
<p>然后重启网络： service network restart</p>
<p>开放指定端口例如 3311</p>
<p>1、使用netstat等命令需要 安装网络工具  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install net-tools</span><br></pre></td></tr></table></figure>
<p>2、关闭CentOS7自带的防火墙 firewall 启用 IPtable </p>
<p>停止 Firewall<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld</span><br></pre></td></tr></table></figure></p>
<p>关闭firewall自动启动<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl <span class="built_in">disable</span> firewalld.service</span><br></pre></td></tr></table></figure></p>
<p>安装IPtables防火墙<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y iptables-services</span><br></pre></td></tr></table></figure></p>
<p>3、修改iptables配置文件，开放3311等端口<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/sysconfig/iptables</span><br></pre></td></tr></table></figure></p>
<p>#添加下面三句话到默认的22端口这条规则的下面<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-A INPUT -m state –state NEW -m tcp -p tcp –dport 80 -j ACCEPT </span><br><span class="line">-A INPUT -m state –state NEW -m tcp -p tcp –dport 3311 -j ACCEPT</span><br></pre></td></tr></table></figure></p>
<p>重启iptables<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart iptables.service</span><br></pre></td></tr></table></figure></p>
<p>添加iptables开机自启项<br>~~~bash<br>        systemctl enable iptables.service</p>
</div></article></div></div></main><footer class="footer-container"><div class="paginator"><a href="/2017/11/30/虚拟机最小化安装centos7 之二《kangle安装》/" class="prev">上一篇</a><a href="/2016/11/18/301跳转代码php实例/" class="next">下一篇</a></div><div class="copyright"><p>© 2017 - 2018 <a href="http://weibo.com/link0502">Mr.Leng</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/AngryPowman/hexo-theme-prontera" target="_blank">hexo-theme-prontera</a>.</p></div></footer></body></html>